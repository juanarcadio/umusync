<entity-mappings xmlns="http://java.sun.com/xml/ns/persistence/orm"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://java.sun.com/xml/ns/persistence/orm http://java.sun.com/xml/ns/persistence/orm_1_0.xsd"
	version="1.0">

	<named-native-query name="UserOfficialImage"  result-set-mapping="UniqueBlob">
		<query>select sakai_umu.PQ_SAKAI_USERS.RECUPERA_FOTO_PARA(:email,:observador) as IMAGE from dual</query>
		<hint name="org.hibernate.callable" value="false" />
		<hint name="org.hibernate.readOnly" value="true" />
	</named-native-query>
	
	<named-native-query name="UserOfficialImagePermitida"  result-set-mapping="UniqueBlob">
		<query>select sakai_umu.PQ_SAKAI_USERS.RECUPERA_FOTO_PERMITIDA_PARA(:email,:observador) as IMAGE from dual</query>
		<hint name="org.hibernate.callable" value="false" />
		<hint name="org.hibernate.readOnly" value="true" />
	</named-native-query>
	
	<named-native-query name="GetDirectorioUMU" result-set-mapping="UniqueColumnString">
		<query>select substr(replace(GENTE.INTERFAZ_CORREO.FN_OBTIENE_VCARD(null,:email).extract('/vcard/atributo[@nombre=''irisClassifCode'']/valor[contains(.,''urn:mace:rediris.es:um.es:classif:FILIACION:'')]/text()').getStringVal(),'urn:mace:rediris.es:um.es:classif:FILIACION:','#'),1)||'#' as resultado from dual</query>
		<hint name="org.hibernate.callable" value="false" />
		<hint name="org.hibernate.readOnly" value="true" />
	</named-native-query>
	
	<sql-result-set-mapping name="UniqueBlob">
		<column-result name="IMAGE"/>
	</sql-result-set-mapping>
	
	<sql-result-set-mapping name="UniqueColumnString">            
	    <column-result name="resultado"/>
	</sql-result-set-mapping>
	
</entity-mappings>
